##########################################################################################
[0] File: /home/remnux/Desktop/New/2/Virus.Win32.Virut.exe
##########################################################################################

Meta-data
==========================================================================================
Size		: 133120 bytes
Type		: PE32 executable (GUI) Intel 80386, for MS Windows
Architecture	: 32 Bits binary
MD5		: 032d0917c1eeec88e7a41dffbf105ccc
SHA1		: 82eb9bc40ff13989a7b6e64240813e25e2202f6d
ssdeep		: 3072:ui6CyPEInRXghvg1pQfuvC8usofkCQt4uZ561JT2uy9Q5qVJmo1G:7mEInRXghTWq8usq/1JT2uy9QvoU
imphash		: cd33652638a31682ec422c6504fc5182
Date		: 0x41107C0C [Wed Aug  4 06:02:52 2004 UTC]
Language	: RUSSIAN
CRC:	(Claimed) : 0x0, (Actual): 0x21716 [SUSPICIOUS]
Entry Point	: 0x1021600 .rsrc 2/3 [SUSPICIOUS]
================
Offset | Instructions
----------------------------------------
0	call 0x1021605
5	push ebp
6	mov ebp,[esp+0x4]
10	sub dword [esp+0x4],0x1690f
18	call 0x1021731
23	mov ecx,eax
25	call 0x1021731
30	sub eax,ecx
32	cmp eax,0x100
37	jnc 0x102170c
43	mov ebx,[esp+0x8]
47	and ebx,0xfffff000
53	sub ebp,0x401005
59	cmp word [ebx],0x5a4d
64	jz 0x102164a
66	sub ebx,0x1000
72	jmp 0x102163b
74	mov eax,[ebx+0x3c]
77	mov edx,[eax+ebx+0x78]
81	lea edx,[edx+ebx]
84	mov esi,[edx+0x20]
87	mov ecx,[edx+0x18]
90	lea esi,[ebx+esi]
93	push ecx
94	lodsd 
95	lea eax,[ebx+eax+0x1]
99	add [eax],al

Version info
==========================================================================================
LegalCopyright	: \xa9 \x41a\x43e\x440\x43f\x43e\x440\x430\x446\x438\x44f \x41c\x430\x439\x43a\x440\x43e\x441\x43e\x444\x442. \x412\x441\x435 \x43f\x440\x430\x432\x430 \x437\x430\x449\x438\x449\x435\x43d\x44b.
InternalName	: WmiApSrv.exe
FileVersion	: 5.1.2600.2180 (xpsp_sp2_rtm.040803-2158)
CompanyName	: \x41a\x43e\x440\x43f\x43e\x440\x430\x446\x438\x44f \x41c\x430\x439\x43a\x440\x43e\x441\x43e\x444\x442
ProductName	: \x41e\x43f\x435\x440\x430\x446\x438\x43e\x43d\x43d\x430\x44f \x441\x438\x441\x442\x435\x43c\x430 Microsoft\xae Windows\xae
ProductVersion	: 5.1.2600.2180
FileDescription	: \x421\x43b\x443\x436\x431\x430 \x430\x434\x430\x43f\x442\x435\x440\x430 \x43f\x440\x43e\x438\x437\x432\x43e\x434\x438\x442\x435\x43b\x44c\x43d\x43e\x441\x442\x438 WMI
OriginalFilename: WmiApSrv.exe
Translation	: 0x0419 0x04b0

Signature scans
==========================================================================================

Clamav: LibClamAV Warning: **************************************************

Sections
==========================================================================================
Name       VirtAddr     VirtSize     RawSize    MD5                              Entropy
------------------------------------------------------------------------------------------
.text      0x1000       0x1d183      0x1d200    221632c9fd77cfc2cfd827797737d597 6.213108    
.data      0x1f000      0x15d8       0x1200     c5edf13c7e9176c0e27e75435513a60c 6.040478    
.rsrc      0x21000      0x6600       0x2000     9f66254b7b2ca1f24699d0519b7bf606 7.576203    [SUSPICIOUS]

Resource entries
==========================================================================================
Resource type      Total   
-------------------------
RT_STRING          : 1       
RT_VERSION         : 1       

Imports
==========================================================================================
[1] msvcrt.dll
[2] ADVAPI32.dll
[3] KERNEL32.dll
[4] USER32.dll
[5] ntdll.dll
[6] OLEAUT32.dll
[7] ole32.dll
[8] loadperf.dll
[9] wbemcomn.dll

Suspicious IAT alerts
==========================================================================================
[1] CreateDirectoryW
[2] CreateFileMappingW
[3] CreateFileW
[4] CreateServiceW
[5] DeleteFileW
[6] GetCommandLineW
[7] GetModuleFileNameW
[8] GetModuleHandleA
[9] GetModuleHandleW
[10] GetProcAddress
[11] GetStartupInfoA
[12] GetTickCount
[13] GetVersionExA
[14] GetVersionExW
[15] LoadLibraryW
[16] MapViewOfFile
[17] OpenProcess
[18] OpenProcessToken
[19] RegCloseKey
[20] RegCreateKeyExA
[21] RegCreateKeyExW
[22] RegDeleteKeyA
[23] RegDeleteKeyW
[24] RegDeleteValueA
[25] RegDeleteValueW
[26] RegEnumKeyA
[27] RegEnumKeyExW
[28] RegEnumKeyW
[29] RegOpenKeyExA
[30] RegOpenKeyExW
[31] RegOpenKeyW
[32] Sleep
[33] StartServiceCtrlDispatcherW
[34] TerminateProcess
[35] UnhandledExceptionFilter
[36] WriteFile

Exports
==========================================================================================
[1] ??0CHPtrArray@@QAE@XZ
[2] ??0CHString@@QAE@ABV0@@Z
[3] ??0CHString@@QAE@GH@Z
[4] ??0CHString@@QAE@PBD@Z
[5] ??0CHString@@QAE@PBE@Z
[6] ??0CHString@@QAE@PBG@Z
[7] ??0CHString@@QAE@PBGH@Z
[8] ??0CHString@@QAE@XZ
[9] ??0CHStringArray@@QAE@XZ
[10] ??0CRegistry@@QAE@ABV0@@Z
[11] ??0CRegistry@@QAE@XZ
[12] ??0CRegistrySearch@@QAE@ABV0@@Z
[13] ??0CRegistrySearch@@QAE@XZ
[14] ??1CHPtrArray@@QAE@XZ
[15] ??1CHString@@QAE@XZ
[16] ??1CHStringArray@@QAE@XZ
[17] ??1CRegistry@@QAE@XZ
[18] ??1CRegistrySearch@@QAE@XZ
[19] ??4CHPtrArray@@QAEAAV0@ABV0@@Z
[20] ??4CHString@@QAEABV0@ABV0@@Z
[21] ??4CHString@@QAEABV0@D@Z
[22] ??4CHString@@QAEABV0@G@Z
[23] ??4CHString@@QAEABV0@PAV0@@Z
[24] ??4CHString@@QAEABV0@PBD@Z
[25] ??4CHString@@QAEABV0@PBE@Z
[26] ??4CHString@@QAEABV0@PBG@Z
[27] ??4CHStringArray@@QAEAAV0@ABV0@@Z
[28] ??4CRegistry@@QAEAAV0@ABV0@@Z
[29] ??4CRegistrySearch@@QAEAAV0@ABV0@@Z
[30] ??ACHPtrArray@@QAEAAPAXH@Z
[31] ??ACHPtrArray@@QBEPAXH@Z
[32] ??ACHString@@QBEGH@Z
[33] ??ACHStringArray@@QAEAAVCHString@@H@Z
[34] ??ACHStringArray@@QBE?AVCHString@@H@Z
[35] ??BCHString@@QBEPBGXZ
[36] ??H@YG?AVCHString@@ABV0@0@Z
[37] ??H@YG?AVCHString@@ABV0@G@Z
[38] ??H@YG?AVCHString@@ABV0@PBG@Z
[39] ??H@YG?AVCHString@@GABV0@@Z
[40] ??H@YG?AVCHString@@PBGABV0@@Z
[41] ??YCHString@@QAEABV0@ABV0@@Z
[42] ??YCHString@@QAEABV0@D@Z
[43] ??YCHString@@QAEABV0@G@Z
[44] ??YCHString@@QAEABV0@PBG@Z
[45] ?Add@CHPtrArray@@QAEHPAX@Z
[46] ?Add@CHStringArray@@QAEHPBG@Z
[47] ?AllocBeforeWrite@CHString@@IAEXH@Z
[48] ?AllocBuffer@CHString@@IAEXH@Z
[49] ?AllocCopy@CHString@@IBEXAAV1@HHH@Z
[50] ?AllocSysString@CHString@@QBEPAGXZ
[51] ?Append@CHPtrArray@@QAEHABV1@@Z
[52] ?Append@CHStringArray@@QAEHABV1@@Z
[53] ?AssignCopy@CHString@@IAEXHPBG@Z
[54] ?CheckAndAddToList@CRegistrySearch@@AAEXPAVCRegistry@@VCHString@@1AAVCHPtrArray@@11H@Z
[55] ?Close@CRegistry@@QAEXXZ
[56] ?CloseSubKey@CRegistry@@AAEXXZ
[57] ?Collate@CHString@@QBEHPBG@Z
[58] ?Compare@CHString@@QBEHPBG@Z
[59] ?CompareNoCase@CHString@@QBEHPBG@Z
[60] ?ConcatCopy@CHString@@IAEXHPBGH0@Z
[61] ?ConcatInPlace@CHString@@IAEXHPBG@Z
[62] ?Copy@CHPtrArray@@QAEXABV1@@Z
[63] ?Copy@CHStringArray@@QAEXABV1@@Z
[64] ?CopyBeforeWrite@CHString@@IAEXXZ
[65] ?CreateOpen@CRegistry@@QAEJPAUHKEY__@@PBGPAGKKPAU_SECURITY_ATTRIBUTES@@PAK@Z
[66] ?DeleteCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBG@Z
[67] ?DeleteCurrentKeyValue@CRegistry@@QAEKPBG@Z
[68] ?DeleteKey@CRegistry@@QAEJPAVCHString@@@Z
[69] ?DeleteValue@CRegistry@@QAEJPBG@Z
[70] ?ElementAt@CHPtrArray@@QAEAAPAXH@Z
[71] ?ElementAt@CHStringArray@@QAEAAVCHString@@H@Z
[72] ?Empty@CHString@@QAEXXZ
[73] ?EnumerateAndGetValues@CRegistry@@QAEJAAKAAPAGAAPAE@Z
[74] ?Find@CHString@@QBEHG@Z
[75] ?Find@CHString@@QBEHPBG@Z
[76] ?FindOneOf@CHString@@QBEHPBG@Z
[77] ?Format@CHString@@QAAXIZZ
[78] ?Format@CHString@@QAAXPBGZZ
[79] ?FormatMessageW@CHString@@QAAXIZZ
[80] ?FormatMessageW@CHString@@QAAXPBGZZ
[81] ?FormatV@CHString@@QAEXPBGPAD@Z
[82] ?FreeExtra@CHPtrArray@@QAEXXZ
[83] ?FreeExtra@CHString@@QAEXXZ
[84] ?FreeExtra@CHStringArray@@QAEXXZ
[85] ?FreeSearchList@CRegistrySearch@@QAEHHAAVCHPtrArray@@@Z
[86] ?GetAllocLength@CHString@@QBEHXZ
[87] ?GetAt@CHPtrArray@@QBEPAXH@Z
[88] ?GetAt@CHString@@QBEGH@Z
[89] ?GetAt@CHStringArray@@QBE?AVCHString@@H@Z
[90] ?GetBuffer@CHString@@QAEPAGH@Z
[91] ?GetBufferSetLength@CHString@@QAEPAGH@Z
[92] ?GetClassNameW@CRegistry@@QAEPAGXZ
[93] ?GetCurrentBinaryKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGPAEPAK@Z
[94] ?GetCurrentBinaryKeyValue@CRegistry@@QAEKPBGAAVCHString@@@Z
[95] ?GetCurrentBinaryKeyValue@CRegistry@@QAEKPBGPAEPAK@Z
[96] ?GetCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGAAK@Z
[97] ?GetCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGAAVCHString@@@Z
[98] ?GetCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGAAVCHStringArray@@@Z
[99] ?GetCurrentKeyValue@CRegistry@@QAEKPBGAAK@Z
[100] ?GetCurrentKeyValue@CRegistry@@QAEKPBGAAVCHString@@@Z
[101] ?GetCurrentKeyValue@CRegistry@@QAEKPBGAAVCHStringArray@@@Z
[102] ?GetCurrentRawKeyValue@CRegistry@@AAEKPAUHKEY__@@PBGPAXPAK3@Z
[103] ?GetCurrentRawSubKeyValue@CRegistry@@AAEKPBGPAXPAK2@Z
[104] ?GetCurrentSubKeyCount@CRegistry@@QAEKXZ
[105] ?GetCurrentSubKeyName@CRegistry@@QAEKAAVCHString@@@Z
[106] ?GetCurrentSubKeyPath@CRegistry@@QAEKAAVCHString@@@Z
[107] ?GetCurrentSubKeyValue@CRegistry@@QAEKPBGAAK@Z
[108] ?GetCurrentSubKeyValue@CRegistry@@QAEKPBGAAVCHString@@@Z
[109] ?GetCurrentSubKeyValue@CRegistry@@QAEKPBGPAXPAK@Z
[110] ?GetData@CHPtrArray@@QAEPAPAXXZ
[111] ?GetData@CHPtrArray@@QBEPAPBXXZ
[112] ?GetData@CHString@@IBEPAUCHStringData@@XZ
[113] ?GetData@CHStringArray@@QAEPAVCHString@@XZ
[114] ?GetData@CHStringArray@@QBEPBVCHString@@XZ
[115] ?GetLength@CHString@@QBEHXZ
[116] ?GetLongestClassStringSize@CRegistry@@QAEKXZ
[117] ?GetLongestSubKeySize@CRegistry@@QAEKXZ
[118] ?GetLongestValueData@CRegistry@@QAEKXZ
[119] ?GetLongestValueName@CRegistry@@QAEKXZ
[120] ?GetPlatformID@CRegistry@@CGKXZ
[121] ?GetSize@CHPtrArray@@QBEHXZ
[122] ?GetSize@CHStringArray@@QBEHXZ
[123] ?GetUpperBound@CHPtrArray@@QBEHXZ
[124] ?GetUpperBound@CHStringArray@@QBEHXZ
[125] ?GetValueCount@CRegistry@@QAEKXZ
[126] ?GethKey@CRegistry@@QAEPAUHKEY__@@XZ
[127] ?Init@CHString@@IAEXXZ
[128] ?InsertAt@CHPtrArray@@QAEXHPAV1@@Z
[129] ?InsertAt@CHPtrArray@@QAEXHPAXH@Z
[130] ?InsertAt@CHStringArray@@QAEXHPAV1@@Z
[131] ?InsertAt@CHStringArray@@QAEXHPBGH@Z
[132] ?IsEmpty@CHString@@QBEHXZ
[133] ?Left@CHString@@QBE?AV1@H@Z
[134] ?LoadStringW@CHString@@IAEHIPAGI@Z
[135] ?LoadStringW@CHString@@QAEHI@Z
[136] ?LocateKeyByNameOrValueName@CRegistrySearch@@QAEHPAUHKEY__@@PBG1PAPBGKAAVCHString@@3@Z
[137] ?LockBuffer@CHString@@QAEPAGXZ
[138] ?MakeLower@CHString@@QAEXXZ
[139] ?MakeReverse@CHString@@QAEXXZ
[140] ?MakeUpper@CHString@@QAEXXZ
[141] ?Mid@CHString@@QBE?AV1@H@Z
[142] ?Mid@CHString@@QBE?AV1@HH@Z
[143] ?NextSubKey@CRegistry@@QAEKXZ
[144] ?Open@CRegistry@@QAEJPAUHKEY__@@PBGK@Z
[145] ?OpenAndEnumerateSubKeys@CRegistry@@QAEJPAUHKEY__@@PBGK@Z
[146] ?OpenCurrentUser@CRegistry@@QAEKPBGK@Z
[147] ?OpenLocalMachineKeyAndReadValue@CRegistry@@QAEJPBG0AAVCHString@@@Z
[148] ?OpenSubKey@CRegistry@@AAEKXZ
[149] ?PrepareToReOpen@CRegistry@@AAEXXZ
[150] ?Release@CHString@@IAEXXZ
[151] ?Release@CHString@@KGXPAUCHStringData@@@Z
[152] ?ReleaseBuffer@CHString@@QAEXH@Z
[153] ?RemoveAll@CHPtrArray@@QAEXXZ
[154] ?RemoveAll@CHStringArray@@QAEXXZ
[155] ?RemoveAt@CHPtrArray@@QAEXHH@Z
[156] ?RemoveAt@CHStringArray@@QAEXHH@Z
[157] ?ReverseFind@CHString@@QBEHG@Z
[158] ?RewindSubKeys@CRegistry@@QAEXXZ
[159] ?Right@CHString@@QBE?AV1@H@Z
[160] ?SafeStrlen@CHString@@KGHPBG@Z
[161] ?SearchAndBuildList@CRegistrySearch@@QAEHVCHString@@AAVCHPtrArray@@00HPAUHKEY__@@@Z
[162] ?SetAt@CHPtrArray@@QAEXHPAX@Z
[163] ?SetAt@CHString@@QAEXHG@Z
[164] ?SetAt@CHStringArray@@QAEXHPBG@Z
[165] ?SetAtGrow@CHPtrArray@@QAEXHPAX@Z
[166] ?SetAtGrow@CHStringArray@@QAEXHPBG@Z
[167] ?SetCHStringResourceHandle@@YGXPAUHINSTANCE__@@@Z
[168] ?SetCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGAAK@Z
[169] ?SetCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGAAVCHString@@@Z
[170] ?SetCurrentKeyValue@CRegistry@@QAEKPAUHKEY__@@PBGAAVCHStringArray@@@Z
[171] ?SetCurrentKeyValue@CRegistry@@QAEKPBGAAK@Z
[172] ?SetCurrentKeyValue@CRegistry@@QAEKPBGAAVCHString@@@Z
[173] ?SetCurrentKeyValue@CRegistry@@QAEKPBGAAVCHStringArray@@@Z
[174] ?SetCurrentKeyValueExpand@CRegistry@@QAEKPAUHKEY__@@PBGAAVCHString@@@Z
[175] ?SetDefaultValues@CRegistry@@AAEXXZ
[176] ?SetSize@CHPtrArray@@QAEXHH@Z
[177] ?SetSize@CHStringArray@@QAEXHH@Z
[178] ?SpanExcluding@CHString@@QBE?AV1@PBG@Z
[179] ?SpanIncluding@CHString@@QBE?AV1@PBG@Z
[180] ?TrimLeft@CHString@@QAEXXZ
[181] ?TrimRight@CHString@@QAEXXZ
[182] ?UnlockBuffer@CHString@@QAEXXZ
[183] ?myRegCreateKeyEx@CRegistry@@AAEJPAUHKEY__@@PBGKPAGKKPAU_SECURITY_ATTRIBUTES@@PAPAU2@PAK@Z
[184] ?myRegDeleteKey@CRegistry@@AAEJPAUHKEY__@@PBG@Z
[185] ?myRegDeleteValue@CRegistry@@AAEJPAUHKEY__@@PBG@Z
[186] ?myRegEnumKey@CRegistry@@AAEJPAUHKEY__@@KPAGK@Z
[187] ?myRegEnumValue@CRegistry@@AAEJPAUHKEY__@@KPAGPAK22PAE2@Z
[188] ?myRegOpenKeyEx@CRegistry@@AAEJPAUHKEY__@@PBGKKPAPAU2@@Z
[189] ?myRegQueryInfoKey@CRegistry@@AAEJPAUHKEY__@@PAGPAK22222222PAU_FILETIME@@@Z
[190] ?myRegQueryValueEx@CRegistry@@AAEJPAUHKEY__@@PBGPAK2PAE2@Z
[191] ?myRegSetValueEx@CRegistry@@AAEJPAUHKEY__@@PBGKKPBEK@Z
[192] ?s_dwPlatform@CRegistry@@0KA

